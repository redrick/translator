<div id='translations'>
  <h1><%= I18n.translate('translator.translations') %></h1>
  <ul>
    <li><%= link_to_unless_current I18n.translate('translator.app_translations'), translations_path(:show => "application") %></li>
    <li><%= link_to_unless_current I18n.translate('translator.framework_translations'), translations_path(:show => "framework") %></li>
    <li><%= link_to_unless_current I18n.translate('translator.all_translations'), translations_path(:show => "all") %></li>
    <li><%= link_to_unless_current I18n.translate('translator.new'), new_translation_path %></li>
  </ul>

  <div>
    <%= form_tag translations_path(:show => params[:show]), :method => "get" do %>
      <%= label_tag :key, I18n.translate('translator.filter') %>
      <%= text_field_tag :search, params[:search], :placeholder => I18n.translate('translator.search_for_text') %>
      <%= select_tag :key, options_for_select([nil] + @all_keys.collect {|k| [k, k]}, params[:key]) %>
      <%= submit_tag I18n.translate('translator.search'), :name => nil %>
    <% end %>
  </div>

  <% unless @total_pages < 2 %>
    <% (1..@total_pages).each do |p| %>
      <%= link_to_unless_current p, translations_path(:show => params[:show], :key => params[:key], :search => params[:search], :page => p) %>
    <% end %>
  <% end %> <br />

  <% unless @keys.length < 1 %>
  <%= submit_tag I18n.translate('translator.save_all'), "data-disable-with" => I18n.translate('translator.saving'), :type => 'button', :class => 'save_all_button' %> <br />
 <% end %>

  <% if @keys.length == 0 %>
  <h2>Nothing found</h2>
  <% end %>

  <% @keys.each do |key| %>
    <%= key %>
      <%= link_to  I18n.translate('translator.delete'), translation_path(:id => 0, :key => key), :method => 'delete' %>
      <% Translator.locales.each do |locale| %>
      <%= render :partial => "form", :locals => {:locale => locale, :key => key} %>
    <% end %>
  <% end %>

  <% unless @keys.length < 1 %>
  <%= submit_tag I18n.translate('translator.save_all'), "data-disable-with" => I18n.translate('translator.saving'), :type => 'button', :class => 'save_all_button' %> <br />
 <% end %>

  <% unless @total_pages < 2 %>
    <% (1..@total_pages).each do |p| %>
      <%= link_to_unless_current p, translations_path(:show => params[:show], :key => params[:key], :search => params[:search], :page => p) %>
    <% end %>
  <% end %>

</div>

<div id="footer">
</div>

<script type="text/javascript">
  $("a[data-recover]").live("click", function(event) {
    event.preventDefault();
    $("input[type='text']", $(this).parents("form")).val($(this).attr("data-recover"));
  });

  $('.save_all_button').live("click", function(event) {
    event.preventDefault();
    $("input[type='submit'][name='commit']").each(function() {
        if ($("input[type='text']", $(this).parents("form")).val() != "") {
            $(this).click();
        }
    });
  });
</script>

